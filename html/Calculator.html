<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RiSync Super Calculator - World's Best Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Math.js for safe and advanced math evaluation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.5.0/math.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.5s ease, color 0.5s ease;
        }
        .bg-gradient-light {
            background-image: linear-gradient(to bottom right, #f0f4f8, #e2e8f0);
        }
        .bg-gradient-dark {
            background-image: linear-gradient(to bottom right, #1f2937, #111827);
        }
        .keypad-button {
            transition: all 0.2s ease;
        }
        .keypad-button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .keypad-button:active {
            transform: scale(0.95);
        }
        /* Styles for the active and inactive tabs */
        .tab-button.active {
            background-color: #6366f1; /* indigo-500 */
            color: white;
        }
        .tab-button {
            transition: all 0.3s ease;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gradient-light dark:bg-gradient-dark text-gray-900 dark:text-gray-100 transition-colors duration-500">

    <div class="min-h-screen p-4 sm:p-6 md:p-8 flex items-center justify-center">
        <div class="w-full max-w-2xl p-4 sm:p-6 md:p-8 bg-white/70 dark:bg-gray-800/70 backdrop-blur-md rounded-3xl shadow-2xl border border-gray-200 dark:border-gray-700 transition-colors duration-500">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-2xl sm:text-3xl lg:text-4xl font-extrabold text-indigo-600 dark:text-indigo-400">RiSync Calculator üöÄ</h1>
                <button id="theme-toggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300">
                    <svg id="sun-icon" class="w-6 h-6 text-gray-800 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                    <svg id="moon-icon" class="w-6 h-6 text-gray-200" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                </button>
            </div>

            <!-- Tab Navigation -->
            <div class="mb-6 flex border-b border-gray-200 dark:border-gray-700">
                <button data-tab="calculator" class="tab-button flex-1 py-2 px-4 font-semibold text-gray-600 dark:text-gray-300 rounded-t-lg">Calculator</button>
                <button data-tab="units" class="tab-button flex-1 py-2 px-4 font-semibold text-gray-600 dark:text-gray-300 rounded-t-lg">Units</button>
                <button data-tab="currency" class="tab-button flex-1 py-2 px-4 font-semibold text-gray-600 dark:text-gray-300 rounded-t-lg">Currency</button>
            </div>

            <!-- Tab Content -->
            <div>
                <!-- Calculator Tab -->
                <div id="tab-calculator" class="tab-content">
                    <div class="mb-4">
                        <input id="math-input" type="text" class="w-full p-4 text-xl sm:text-2xl border-2 border-indigo-200 dark:border-indigo-700 rounded-2xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-4 focus:ring-indigo-300 dark:focus:ring-indigo-600 transition-all duration-300 shadow-inner" placeholder="Calculate something amazing..."/>
                    </div>
                    <div id="solution-container" class="min-h-[4rem] p-4 text-xl sm:text-2xl font-bold rounded-2xl bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 shadow-inner flex items-center justify-end">
                        <span id="solution-text" class="text-right text-gray-800 dark:text-gray-200">0</span>
                    </div>
                    <div id="error-message" class="hidden mt-2 p-2 bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 rounded-xl shadow-inner text-sm"><p id="error-text"></p></div>
                    
                    <div id="keypad" class="grid grid-cols-5 gap-2 sm:gap-3 mt-6">
                        <!-- Scientific Functions -->
                        <button data-key="sin(" class="keypad-button p-3 text-lg font-bold rounded-xl text-white bg-purple-500 hover:bg-purple-600">sin</button>
                        <button data-key="cos(" class="keypad-button p-3 text-lg font-bold rounded-xl text-white bg-purple-500 hover:bg-purple-600">cos</button>
                        <button data-key="tan(" class="keypad-button p-3 text-lg font-bold rounded-xl text-white bg-purple-500 hover:bg-purple-600">tan</button>
                        <button data-key="log(" class="keypad-button p-3 text-lg font-bold rounded-xl text-white bg-purple-500 hover:bg-purple-600">log</button>
                        <button data-key="sqrt(" class="keypad-button p-3 text-lg font-bold rounded-xl text-white bg-purple-500 hover:bg-purple-600">‚àö</button>
                        <!-- Standard Numbers and Operators -->
                        <button data-key="7" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">7</button>
                        <button data-key="8" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">8</button>
                        <button data-key="9" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">9</button>
                        <button data-key="/" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-white bg-indigo-500 hover:bg-indigo-600">√∑</button>
                        <button id="backspace" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-white bg-gray-400 hover:bg-gray-500">‚Üê</button>
                        <button data-key="4" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">4</button>
                        <button data-key="5" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">5</button>
                        <button data-key="6" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">6</button>
                        <button data-key="*" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-white bg-indigo-500 hover:bg-indigo-600">√ó</button>
                        <button data-key="^" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-white bg-indigo-500 hover:bg-indigo-600">^</button>
                        <button data-key="1" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">1</button>
                        <button data-key="2" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">2</button>
                        <button data-key="3" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">3</button>
                        <button data-key="-" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-white bg-indigo-500 hover:bg-indigo-600">‚àí</button>
                        <button data-key="(" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">(</button>
                        <button data-key="0" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600 col-span-2">0</button>
                        <button data-key="." class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">.</button>
                        <button data-key="+" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-white bg-indigo-500 hover:bg-indigo-600">+</button>
                        <button data-key=")" class="keypad-button p-3 sm:p-4 text-xl sm:text-2xl font-bold rounded-xl text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-600">)</button>
                        <button id="clear-input" class="keypad-button p-3 text-xl font-bold rounded-xl text-white bg-red-500 hover:bg-red-600 col-span-2">C</button>
                        <button id="calculate" class="keypad-button p-3 text-xl font-bold rounded-xl text-white bg-green-500 hover:bg-green-600 col-span-3">=</button>
                    </div>
                </div>

                <!-- Units Tab -->
                <div id="tab-units" class="tab-content">
                    <p class="mb-4 text-center text-gray-600 dark:text-gray-400">Convert between different units of measurement.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end">
                        <div class="flex flex-col">
                            <label for="unit-category" class="block font-semibold mb-1">Category</label>
                            <select id="unit-category" class="w-full p-3 text-lg border-2 border-purple-300 dark:border-purple-700 rounded-xl bg-gray-50 dark:bg-gray-700"></select>
                        </div>
                        <div class="flex flex-col">
                            <label for="amount-units" class="block font-semibold mb-1">Value</label>
                            <input id="amount-units" type="number" class="w-full p-3 text-lg border-2 border-purple-300 dark:border-purple-700 rounded-xl bg-gray-50 dark:bg-gray-700" value="1" step="any"/>
                        </div>
                        <div class="flex flex-col">
                            <label for="units-from" class="block font-semibold mb-1">From</label>
                            <select id="units-from" class="w-full p-3 text-lg border-2 border-purple-300 dark:border-purple-700 rounded-xl bg-gray-50 dark:bg-gray-700"></select>
                        </div>
                        <div class="flex flex-col">
                            <label for="units-to" class="block font-semibold mb-1">To</label>
                            <select id="units-to" class="w-full p-3 text-lg border-2 border-purple-300 dark:border-purple-700 rounded-xl bg-gray-50 dark:bg-gray-700"></select>
                        </div>
                    </div>
                    <div id="units-result-container" class="mt-6 min-h-[4rem] p-4 text-xl sm:text-2xl font-bold rounded-2xl bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 flex items-center justify-center">
                        <span id="units-result-text" class="text-gray-800 dark:text-gray-200">Result...</span>
                    </div>
                </div>

                <!-- Currency Converter Tab -->
                <div id="tab-currency" class="tab-content">
                     <p class="mb-4 text-center text-gray-600 dark:text-gray-400">Live currency conversion using real-time rates.</p>
                     <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                        <div>
                            <label for="amount-from" class="block font-semibold mb-1">Amount</label>
                            <input id="amount-from" type="number" class="w-full p-3 text-lg border-2 border-green-300 dark:border-green-700 rounded-xl bg-gray-50 dark:bg-gray-700" value="1"/>
                        </div>
                        <div>
                            <label for="currency-from" class="block font-semibold mb-1">From</label>
                            <select id="currency-from" class="w-full p-3 text-lg border-2 border-green-300 dark:border-green-700 rounded-xl bg-gray-50 dark:bg-gray-700"></select>
                        </div>
                        <div>
                            <label for="currency-to" class="block font-semibold mb-1">To</label>
                            <select id="currency-to" class="w-full p-3 text-lg border-2 border-green-300 dark:border-green-700 rounded-xl bg-gray-50 dark:bg-gray-700"></select>
                        </div>
                     </div>
                     <div id="currency-result-container" class="mt-6 min-h-[4rem] p-4 text-xl sm:text-2xl font-bold rounded-2xl bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 flex items-center justify-center">
                        <span id="currency-result-text">Result...</span>
                     </div>
                </div>
            </div>
        </div>
				<button id="backButton" onclick="window.location.href='content.html'">‚Üê Back</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Global DOM Elements ---
            const themeToggle = document.getElementById('theme-toggle');
            const sunIcon = document.getElementById('sun-icon');
            const moonIcon = document.getElementById('moon-icon');
            
            // --- Tab Elements ---
            const tabs = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            // --- Calculator Elements ---
            const mathInput = document.getElementById('math-input');
            const keypad = document.getElementById('keypad');
            const calculateBtn = document.getElementById('calculate');
            const clearInputBtn = document.getElementById('clear-input');
            const backspaceBtn = document.getElementById('backspace');
            const solutionText = document.getElementById('solution-text');
            const errorMessage = document.getElementById('error-message');
            const errorText = document.getElementById('error-text');

            // --- Units Converter Elements ---
            const amountUnits = document.getElementById('amount-units');
            const unitCategory = document.getElementById('unit-category');
            const unitsFrom = document.getElementById('units-from');
            const unitsTo = document.getElementById('units-to');
            const unitsResultText = document.getElementById('units-result-text');

            // --- Currency Converter Elements ---
            const amountFrom = document.getElementById('amount-from');
            const currencyFrom = document.getElementById('currency-from');
            const currencyTo = document.getElementById('currency-to');
            const currencyResultText = document.getElementById('currency-result-text');
            let currencyRates = {};

            // --- Theme Toggle Logic ---
            const applyTheme = (isDark) => {
                document.documentElement.classList.toggle('dark', isDark);
                sunIcon.classList.toggle('hidden', !isDark);
                moonIcon.classList.toggle('hidden', isDark);
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
            };
            const initialIsDarkMode = localStorage.getItem('theme') === 'dark' || 
                                      (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches);
            applyTheme(initialIsDarkMode);
            themeToggle.addEventListener('click', () => applyTheme(!document.documentElement.classList.contains('dark')));

            // --- Tab Switching Logic ---
            const switchTab = (tabId) => {
                tabContents.forEach(content => content.classList.remove('active'));
                tabs.forEach(tab => tab.classList.remove('active'));
                document.getElementById(`tab-${tabId}`).classList.add('active');
                document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
            };
            tabs.forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab.dataset.tab));
            });
            switchTab('calculator'); // Set initial tab

            // --- Calculator Logic ---
            const solveExpression = () => {
                errorMessage.classList.add('hidden');
                const expression = mathInput.value;
                if (!expression) return;
                try {
                    let result = math.evaluate(expression);
                    solutionText.textContent = math.format(result, { precision: 14 });
                } catch (e) {
                    errorText.textContent = e.message;
                    errorMessage.classList.remove('hidden');
                    solutionText.textContent = 'Error';
                }
            };

            keypad.addEventListener('click', (event) => {
                const target = event.target.closest('button');
                if (!target || !target.dataset.key) return;
                mathInput.value += target.dataset.key;
                mathInput.focus();
            });
            clearInputBtn.addEventListener('click', () => {
                mathInput.value = '';
                solutionText.textContent = '0';
                errorMessage.classList.add('hidden');
            });
            backspaceBtn.addEventListener('click', () => {
                mathInput.value = mathInput.value.slice(0, -1);
            });
            calculateBtn.addEventListener('click', solveExpression);
            mathInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    solveExpression();
                }
            });

            // --- Units Converter Logic ---
            const unitData = {
                length: {
                    meters: { name: 'Meters', factor: 1 },
                    kilometers: { name: 'Kilometers', factor: 1000 },
                    centimeters: { name: 'Centimeters', factor: 0.01 },
                    millimeters: { name: 'Millimeters', factor: 0.001 },
                    miles: { name: 'Miles', factor: 1609.34 },
                    yards: { name: 'Yards', factor: 0.9144 },
                    feet: { name: 'Feet', factor: 0.3048 },
                    inches: { name: 'Inches', factor: 0.0254 }
                },
                mass: {
                    grams: { name: 'Grams', factor: 1 },
                    kilograms: { name: 'Kilograms', factor: 1000 },
                    milligrams: { name: 'Milligrams', factor: 0.001 },
                    pounds: { name: 'Pounds', factor: 453.592 },
                    ounces: { name: 'Ounces', factor: 28.3495 }
                },
                volume: {
                    liters: { name: 'Liters', factor: 1 },
                    milliliters: { name: 'Milliliters', factor: 0.001 },
                    gallons: { name: 'Gallons', factor: 3.78541 },
                    pints: { name: 'Pints', factor: 0.473176 },
                    cups: { name: 'Cups', factor: 0.236588 }
                }
            };

            const populateUnitDropdowns = () => {
                // Populate categories
                for (const category in unitData) {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category.charAt(0).toUpperCase() + category.slice(1);
                    unitCategory.appendChild(option);
                }

                updateUnits(); // Populate units for the initial category
            };

            const updateUnits = () => {
                const selectedCategory = unitCategory.value;
                const units = unitData[selectedCategory];

                // Clear existing options
                unitsFrom.innerHTML = '';
                unitsTo.innerHTML = '';

                // Populate with new options
                for (const unitKey in units) {
                    const optionFrom = document.createElement('option');
                    optionFrom.value = unitKey;
                    optionFrom.textContent = units[unitKey].name;
                    unitsFrom.appendChild(optionFrom);

                    const optionTo = document.createElement('option');
                    optionTo.value = unitKey;
                    optionTo.textContent = units[unitKey].name;
                    unitsTo.appendChild(optionTo);
                }
                convertUnits(); // Perform initial conversion on unit change
            };

            const convertUnits = () => {
                const value = parseFloat(amountUnits.value);
                const category = unitCategory.value;
                const fromUnitKey = unitsFrom.value;
                const toUnitKey = unitsTo.value;

                if (isNaN(value)) {
                    unitsResultText.textContent = "Please enter a valid number.";
                    return;
                }

                const categoryData = unitData[category];
                if (!categoryData || !categoryData[fromUnitKey] || !categoryData[toUnitKey]) {
                    unitsResultText.textContent = "Error: Invalid unit selected.";
                    return;
                }

                const fromFactor = categoryData[fromUnitKey].factor;
                const toFactor = categoryData[toUnitKey].factor;
                const result = (value * fromFactor) / toFactor;
                
                unitsResultText.textContent = `${result.toFixed(4)} ${categoryData[toUnitKey].name}`;
            };
            
            // Event listeners for the units converter
            unitCategory.addEventListener('change', updateUnits);
            unitsFrom.addEventListener('change', convertUnits);
            unitsTo.addEventListener('change', convertUnits);
            amountUnits.addEventListener('input', convertUnits);

            populateUnitDropdowns(); // Initialize units on page load

            // --- Currency Converter Logic ---
            const fetchCurrencies = async () => {
                try {
                    const response = await fetch('https://open.er-api.com/v6/latest/USD');
                    const data = await response.json();
                    if (data.result === 'success') {
                        currencyRates = data.rates;
                        const currencies = Object.keys(currencyRates);
                        populateCurrencyDropdowns(currencies);
                        convertCurrency();
                    }
                } catch (error) {
                    currencyResultText.textContent = "Could not load rates.";
                    console.error("Currency fetch error:", error);
                }
            };

            const populateCurrencyDropdowns = (currencies) => {
                currencies.forEach(currency => {
                    const option1 = document.createElement('option');
                    option1.value = currency;
                    option1.textContent = currency;
                    currencyFrom.appendChild(option1);

                    const option2 = document.createElement('option');
                    option2.value = currency;
                    option2.textContent = currency;
                    currencyTo.appendChild(option2);
                });
                currencyFrom.value = 'USD';
                currencyTo.value = 'EUR';
            };

            const convertCurrency = () => {
                const amount = parseFloat(amountFrom.value);
                const from = currencyFrom.value;
                const to = currencyTo.value;

                if (isNaN(amount) || !from || !to || !currencyRates[from] || !currencyRates[to]) {
                    currencyResultText.textContent = '...';
                    return;
                }

                const amountInUSD = amount / currencyRates[from];
                const result = amountInUSD * currencyRates[to];
                currencyResultText.textContent = `${amount.toFixed(2)} ${from} = ${result.toFixed(2)} ${to}`;
            };
            
            fetchCurrencies();
            amountFrom.addEventListener('input', convertCurrency);
            currencyFrom.addEventListener('change', convertCurrency);
            currencyTo.addEventListener('change', convertCurrency);
        });
    </script>

</body>
</html>
